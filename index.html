<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Redirecting...</title>
    <!-- Importa o script do Telegram Web App -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* Reset básico para todos os elementos */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Estilos para o corpo da página */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #ffffff; /* Fundo branco, como solicitado */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* Container centralizado para o conteúdo */
        .container {
            text-align: center;
            padding: 20px;
            max-width: 300px;
            width: 90%;
        }

        /* Estilos para a logo da Pocket Option */
        .logo {
            max-width: 100%;
            height: auto;
            margin-bottom: 30px;
        }

        /* Container para a barra de progresso */
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        /* O elemento da barra de progresso */
        .progress-bar {
            width: 0%;
            height: 100%;
            background-color: #1D63F2; /* Tom de azul ajustado para combinar com a logo */
            border-radius: 4px;
            transition: width 0.8s cubic-bezier(0.25, 0.1, 0.25, 1); /* Transição suave para a mudança de largura */
        }
        
        /* Efeito de brilho para a barra de carregamento */
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 1.5s infinite linear;
        }

        /* Animação de keyframes para o brilho */
        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo da Pocket Option -->
        <img src="https://1000logos.net/wp-content/uploads/2023/11/Pocket-Option-Logo.png" alt="Pocket Option Logo" class="logo">
        
        <!-- Barra de Carregamento Moderna -->
        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>
    </div>

    <script>
        // --- Configuração ---
        const PLATFORM_URL = 'https://pocketoption.com/register?utm_campaign=826608&utm_source=affiliate&utm_medium=sr&a=kiEkiwPsh6owpd&ac=lorenzo-global-postback1&code=50START&click_id=';
        
        // --- Elementos do DOM ---
        const progressBar = document.getElementById('progressBar');

        // --- Função de Tratamento de Erro ---
        function handleError(errorMessage) {
            console.error('Ocorreu um erro:', errorMessage);
            
            // Indica o erro visualmente na barra de progresso
            progressBar.style.backgroundColor = '#E53935'; // Vermelho
            progressBar.style.width = '100%';

            // Redireciona para uma URL de fallback após um curto intervalo
            setTimeout(() => {
                window.location.href = PLATFORM_URL + 'error_no_id';
            }, 1200);
        }

        // --- Função Principal ---
        function initializeRedirect() {
            // Inicia a animação da barra para dar feedback imediato ao usuário
            setTimeout(() => {
                progressBar.style.width = '30%';
            }, 100);

            // Verifica se o objeto Telegram Web App está disponível
            if (typeof window.Telegram === 'undefined' || !window.Telegram.WebApp) {
                handleError('Contexto do Telegram não encontrado.');
                return; // Para a execução se o Telegram não estiver disponível
            }

            const tg = window.Telegram.WebApp;

            // A função ready() é chamada quando o Web App está totalmente inicializado
            tg.ready(() => {
                try {
                    // Expande o app para tela cheia
                    tg.expand();
                    
                    // Avança a barra de progresso para indicar atividade
                    progressBar.style.width = '75%';

                    // Pega o ID do usuário dos dados do Telegram
                    const userId = tg.initDataUnsafe?.user?.id;
                    
                    if (userId) {
                        // Se o ID do usuário for encontrado, completa o processo
                        const finalUrl = PLATFORM_URL + userId;
                        console.log('ID de usuário encontrado:', userId);
                        console.log('Redirecionando para:', finalUrl);

                        // Completa a animação da barra de progresso
                        progressBar.style.width = '100%';

                        // Redireciona após um breve momento para a animação terminar
                        setTimeout(() => {
                            window.location.href = finalUrl;
                        }, 500);
                    } else {
                        // Se o ID do usuário não for encontrado, aciona o tratamento de erro
                        handleError('Não foi possível obter o ID de usuário do Telegram.');
                    }
                } catch (e) {
                    // Captura qualquer outro erro inesperado que possa ocorrer
                    handleError(e.message);
                }
            });
        }

        // Executa a função principal
        initializeRedirect();
    </script>
</body>
</html>
